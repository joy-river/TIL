### 프로세스(Process)
---
* 프로세스란 무엇인가?

    * 프로그램이냐 프로세스냐 그것이 문제로다.

        > 프로그램이란, **어떤 활동을 수행하는 방법**이다.
        > 쉽게 얘기하면 cpu에 의해 실행되는 코드 덩어리다.
    
    * 프로그램은 Code with data라고 볼 수 있으며, 코드란 명령어들의 나열(Sequence of instructions)이다.

    * 프로그램은 최종적으로 실행 가능한 파일(Executable file)의 형태로 존재한다.

    * 그렇다면 프로세스는 무엇인가?

        > 프로세스란, **실행되는 프로그램의 특정 시점을 찍은 스냅샷** 이다.
        > 쉽게 얘기하면, 프로그램의 실행 중인 인스턴스라고 볼 수 있다.

    * 프로그램과 프로세스는 서로 비슷하게 쓰이지만, 의미가 다르므로 주의해야 한다.

        * 프로그램 하나에 여러 프로세스가 존재할 수 있다.

    * 프로세스는 필수적으로 메모리 공간을 차지하게 된다.

        * 프로그램의 코드와 데이터도 실행을 위해 메모리에 존재한다.

    * 또한 프로세스는 자기만의 CPU state를 가진다. (registers, pc, sp, etc...)

    * 또한 OS state도 가진다.(open files, sockets etc....)

### 프로세스 주소 공간(Process Address Space)
---
* 프로세스는 자신만의 가상의 주소 공간(Virtual Memory Address Space)을 가진다

    > DRAM(Main Memory)의 고유한 특징 = Addressable하다

    * 32비트 시스템에선 0 부터 $2^32 -1$ 까지의 주소를 가지고 있다.

        * 따라서 한 프로세스가 가질 수 있는 최대의 주소 공간은 $2^32$ 바이트가 된다

    * 64비트 시스템에서는 48비트만 주소에 사용하므로 0 ~ $2^48 -1$ 까지의 주소를 가진다.

        * 따라서 64비트에서는 한 프로세스가 최대 $2^48$ 바이트까지 사용할 수 있다.
    
* 주소 공간은 여러 종류의 세그먼트(Segment)로 나뉘어진다.

    > 1. 텍스트(Text segment) = 프로그램 코드(read only)  

    <br>

    > 2. 데이터(Data segment) = 초기화된 전역 변수들(Global vars.)  

    <br>

    > 3. 스택(Stack segment) = 함수, 시스템 콜, 지역 변수들(func, system calls, local vars..)

    <br>

    > 4. BSS segment = 초기화되지 않은 전역 변수

    <br>

    > 5. 힙(Heap segment) = 동적 할당되는 데이터(malloc시 포인터가 가리키는 장소)

    <br>

    * 스택과 힙은 다른 세그먼트와 다르게 화살표가 있다.(= 크기가 동적으로 변화한다.)

        * 스택은 아래 방향, 힙은 위 방향으로 세그먼트의 크기가 점점 커진다

        * 스택과 힙을 제외한 세그먼트는 크기가 고정되어있다.

* 똑같은 프로그램을 여러 번 호출해도 완전히 다른 주소 공간을 가지는 여러 프로세스들이 만들어지게 된다.

### 프로세스 스위칭(Process Switching)
---
* CPU는 하나 밖에 존재하지 않고, 시간 공유 자원이므로 **한 cpu에서는 동시에 단 하나의 프로세스**만 실행할 수 있다.

* 만약 prog1과 prog2가 동시에 실행 중이라고 가정한다면

    1. prog1이 cpu에서 실행된 후, prog1를 중단(suspend)시키고 prog1이 사용했던 레지스터의 내용(prog1 state)을 메모리에 저장한다.

    2. prog2 state를 메모리에서 로드하여 prog2를 주어진 시간만큼 다시 작업한다.

    3. 작업이 끝나면 prog2를 중단, 상태를 메모리에 기록하고 prog1 state를 불러와 작업한다..

* 이 과정을 프로세스의 스위칭이라고 부른다.

    * 각 프로세스는 약 100ms의 시간 동안만 cpu에서 작업될 수 있다.

    * 인간에 관점에서는 프로세스들이 동시에 실행되는 듯한 환상을 보게 된다.

* OS가 자원 관리자로써 프로세스들의 스위칭을 담당한다.

    > 이를 **스케줄러(Scheduler)** 라고 부른다.

    * 스케줄러는 다음 처리될 프로세스를 선택하는 것이다.

    * 따라서 OS의 가장 아래 계층(Lowest Layer)에 스케줄러가 위치한다.

* 프로세스는 3가지의 상태(state)를 가진다.

    * 실행중(Running) 상태

        > 프로세스가 현재 cpu에서 처리되고 있으며, 단 하나의 프로세스만 이 상태에 있을 수 있다. 자신에게 주어진 시간이 끝나게 되면 대기 상태로 이동한다.
    
    * 대기(Ready) 상태

        > 프로세스가 실행중이 아니며, cpu를 점유하지 않고 sleep, suspended 된 상태이다. 스케줄러는 대기 상태의 프로세스 중에 다음 실행될 프로세스를 선택한다.

    * 블록(Blocked) 상태

        > 대기 상태처럼 cpu를 사용하지 않는 상태지만, 입력(Input)을 기다리고 있는 상태. 입력이 도착하면 대기 상태로 이동한다.