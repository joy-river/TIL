### Network Core

---

- 네트워크의 코어는 상호 연결된 라우터로 구성되어 있다.

  - 이 라우터들은 패킷 스위칭을 통해 데이터를 주고 받는다.

  - 모든 패킷은 링크를 통해서 Source에서 Destination까지 이동한다.(Forwarding)

  - 링크가 꽉 찼을 때 패킷이 전송된다. (Store and Forward)

  - 이때 패킷의 전송시간(Packet Transmission Delay)는 L / R (패킷의 길이 / 시간당 전송 가능한 비트 수)로 계산할 수 있다.

  - 패킷이 도착하는 속도가 전송하는 속도보다 빠른 경우

    - 패킷이 Queue에 쌓여 전송되기를 기다린다.

    - 만약 버퍼가 꽉 차면, 일부 패킷이 loss될 가능성도 있다.

- 네트워크의 코어는 크게 두 개의 Function을 가진다.

  - Forwarding

    - local한 작업이며, 라우터의 입력 링크에서 적절한 출력 링크로 보내기만 하는 작업이다.

  - Routing

    - Global한 작업이며, Source-Destination 간에 최적의 경로를 찾아 패킷을 전송한다.

    - 이때 다익스트라나 벨만-포드 알고리즘 등 라우팅 알고리즘을 사용한다.

### Circuit Switching

---

- 서킷 스위칭은 일종의 연탄이다.

  - 안쓰는 것은 아니지만, 대세에는 밀린 기술이다.

- 회선 하나를 전용으로 사용한다.

  - 종단간 자원을 할당하고, 출발지와 도착지가 서로 Call을 약속하고 대기한다.

- 자원을 공유하지 않는다.

  - 회로와 비슷하며, 일정한 성능을 보장한다.

  - circuit segment가 사용되지 않을때는 가동하지 않는다.(공유 X)

- 이 단일 회선(정해진 대역폭)에서 여러 신호를 보내기 위해 다중화(Multiflexing)을 사용한다.

  - FDM(Frequency Division Mux)

    > FDM은 대역폭을 여러 주파수로 나누고, 각 주파수에 대응하는 신호를 보내게 만드는 기술이다.

  - TDM(Time Division Mux)

    > TDM은 대역폭을 시간에 따라 분할하여 할당받은 Time Slot에 신호를 전송하게 하는 기술이다.
    > 2g 기술에 사용되었다.

  - Frequency hopping(FDM + TDM)

    > 특정 Time slot에 무작위 주파수에 할당된 신호를 전송한다.

  - CDMA(Code Division Mutiple Access)

    > 각 사용자가 다른 코드를 통해 신호를 전송하게 만든다.
    > 일부의 2g와 3g 기술에 사용되었다.

  - OFDM(Orthogonal Frequency Division Mux)

    > FDM 처럼 주파수를 활용하는 기술이다.

    > FDM은 주파수의 중복을 방지하는 guard band가 추가적인 오버헤드를 발생시켰으나, OFDM은 이를 해결한 기술이다.

    > 4g 기술에 사용하고 있다.

### Circuit VS Packet

---

- 그렇다면 서킷 스위칭은 항상 패킷 스위칭에 밀리는가? 즉, 패킷 스위칭이 Slam dunk winner인가?

- 서킷의 장단점을 살펴보자

  - Service Quality를 보장하기 쉽다.

    - 자원을 남과 공유하지 않으므로, 내가 할당받은 양을 대역폭을 항상 사용할 수 있다.

  - Call 중에 자원이 낭비된다.

    - 전체 네트워크를 고려하면, 남는 대역폭은 공유하는게 더 낫다.

  - 데이터가 loss될 일이 없다.(이미 reserved 되어있으므로.)

  - 비효율적이나 장시간 연속적인 Traffic에 적합하다(목소리 등).

  - 큐잉 지연을 완화할 수 있다.

- 패킷의 장단을 살펴보자.

  - 한정적인 자원에서 최고의 성능을 보장하긴 힘들다.

    - Best effort라고 볼 수 있다.

  - 데이터가 짧은 시간동안 집중적으로 발생되는 Busty traffic에 적합하다.

  - 필요할 때만, 필요에 의해 네트워크를 사용하므로 효율적이다.

  - 패킷이 손실될 가능성이 있다.

- 예시를 들어 1기가 대역폭의 링크가 있다고 가정하자.

- 사용중인 상태일 때 100메가를 사용하고, 전체 시간의 10%동안 사용한다고 가정하자.

  - 서킷으로는 총 10명의 사용자만 사용할 수 있다.

  - 패킷으로는 대략 35명 정도가 동시에 사용할 수 있다.

    - 어느 시점에 한 명이 사용 중일 확률은 0.1이고, 35명 중에서 10명 초과 사용자가 발생할 확률은 0.0004 미만이기 때문이다.

- 만약 패킷으로도 처리할 수 없는 트래픽 폭주가 발생할 경우, 일종의 병목 현상이 발생한다.

  - 4계층의 TCP가 Conjestion Control을 진행한다.

- 인터넷은 현재 패킷 스위칭을 통해 돌아간다.

  - 호스트는 ISP를 통해 인터넷에 연결된다.

  - ISP는 다른 ISP와 상호 연결되어, 두 호스트가 패킷을 주고받을 수 있게 한다.

  - 따라서 Network of networks 즉 인터넷은 엄청나게 복잡하게 구성되어있다.
